clc
close all
clear all
%function out = autobase_capno2()
load('0309_8min.mat');
fs=300;
%i=input('which dataset chosen');
%y=[0.390646	0.846606	0.932959	0.933755	0.934689	0.93598	0.930157	0.931613	0.932492	0.933261	0.932849	0.933069	0.932739	0.933398	0.934003	0.935733	0.936694	0.937738	0.939359	0.93988	0.940842	0.940869	0.938754	0.933344	0.928262	0.927658	0.927658	0.929718	0.930899	0.93219	0.933206	0.933618	0.933646	0.933646	0.933316	0.933344	0.934085	0.935101	0.936063	0.937299	0.938177	0.938837	0.939853	0.94021	0.939413	0.932657	0.928372	0.926477	0.926971	0.927795	0.929828	0.93035	0.932739	0.933261	0.932986	0.933069	0.932739	0.932822	0.933701	0.935239	0.935596	0.937161	0.938232	0.939001	0.939359	0.939963	0.939633	0.933151	0.928152	0.926697	0.925543	0.927328	0.928015	0.929581	0.930185	0.931146	0.931915	0.931696	0.931613	0.931641	0.932217	0.932904	0.93403	0.935376	0.936365	0.937326	0.937491	0.939331	0.938947	0.937436	0.92991	0.926202	0.924884	0.92612	0.927383	0.929059	0.929773	0.930954	0.931339	0.931696	0.931531	0.931146	0.931393	0.931998	0.932904	0.934113	0.934827	0.936035	0.936392	0.937189	0.937546	0.93848	0.93793	0.933206	0.926862	0.925021	0.924252	0.925516	0.926889	0.92785	0.928867	0.93002	0.930679	0.930295	0.930322	0.930157	0.930624	0.931256	0.931778	0.932492	0.93436	0.934854	0.935458	0.936667	0.937189	0.937491	0.938013	0.933508	0.929251	0.925406	0.923291	0.923538	0.924747	0.925845	0.927081	0.928702	0.929471	0.929938	0.929691	0.929581	0.929498	0.929993	0.930487	0.931366	0.932629	0.933316	0.934744	0.935156	0.936063	0.937134	0.937985	0.936667	0.932135	0.925571	0.923758	0.923209	0.923868	0.925351	0.926779	0.927768	0.928345	0.929663	0.929938	0.929965	0.9298	0.929938	0.930322	0.931558	0.932108	0.933536	0.934689	0.935239	0.936337	0.937134	0.937628	0.938425	0.938177	0.935953	0.930844	0.925488	0.925186	0.924994	0.926889	0.928043	0.928812	0.93024	0.931311	0.931146	0.930817	0.930405	0.930542	0.930707	0.931256	0.932465	0.932849	0.934277	0.935541	0.936145	0.937161	0.93804	0.938095	0.93782	0.933838	0.929883	0.9259	0.924197	0.92428	0.925626	0.926147	0.92807	0.929196	0.93024	0.930789	0.930734	0.930157	0.93024	0.931119	0.931476	0.932272	0.933508	0.934277	0.935376	0.936282	0.937134	0.937601	0.938397	0.938589	0.938177	0.931064	0.928043	0.925214	0.924747	0.925186	0.926807	0.927466	0.929526	0.93035	0.930844	0.930981	0.930707	0.930487	0.930487	0.93186	0.932217	0.933426	0.934525	0.935486	0.936392	0.937326	0.937793	0.938699	0.938947	0.939194	0.934415	0.928619	0.926834	0.925708	0.926175	0.927493	0.9284	0.929196	0.930872	0.932053	0.931833	0.931421	0.931119	0.931174	0.931174	0.93197	0.932794	0.933783	0.934909	0.935678	0.93642	0.937161	0.93793	0.938837	0.937326	0.934305	0.927411	0.925351	0.924445	0.925214	0.926532	0.92785	0.928949	0.92991	0.931119	0.931229	0.931036	0.930679	0.931503	0.931503	0.932657	0.933453	0.934442	0.935678	0.936255	0.936996	0.937711	0.93793	0.93837	0.937546	0.933344	0.929141	0.924664	0.923648	0.92373	0.925159	0.926614	0.927768	0.929031	0.929031	0.929581	0.929224	0.928976	0.929526	0.93013	0.930679	0.931366	0.933234	0.93414	0.934991	0.936118	0.936612	0.936722	0.937354	0.936914	0.932327	0.927054	0.924362	0.92373	0.924225	0.925076	0.926532	0.927109	0.928702	0.929581	0.929636	0.929636	0.929745	0.92991	0.930048	0.931229	0.931833	0.932877	0.934222	0.934827	0.935898	0.936694	0.937244	0.93782	0.936282	0.932932	0.926093	0.924554	0.923676	0.924939	0.926175	0.927164	0.928482	0.929498	0.930267	0.93035	0.930157	0.930075	0.930322	0.930899	0.931696	0.932822	0.933344	0.934525	0.936282	0.936694	0.937354	0.938315	0.939001	0.938617	0.934387	0.930542	0.926038	0.925653	0.925626	0.92774	0.928674	0.929828	0.931009	0.932547	0.93241	0.931833	0.931641	0.931613	0.932327	0.932657	0.934058	0.934882	0.935541	0.936063	0.936859	0.937326	0.938013	0.938974	0.937463	0.932355	0.927823	0.925818	0.925433	0.92612	0.927026	0.928976	0.929855	0.930899	0.931448	0.93197	0.931613	0.931393	0.931421	0.932272	0.932904	0.933536	0.934634	0.935925	0.93609	0.937463	0.93848	0.938699	0.937793	0.932465	0.927548	0.924884	0.924554	0.924527	0.926395	0.927054	0.927988	0.929416	0.930267	0.930927	0.93046	0.930267	0.930405	0.930515	0.931036	0.932217	0.933563	0.93403	0.935074	0.936639	0.936887	0.937573	0.937244	0.934662	0.928949	0.925296	0.924582	0.924911	0.925818	0.926889	0.928372	0.929306	0.930652	0.930927	0.930267	0.930267	0.930377	0.930487	0.931009	0.930899	0.931339	0.932108	0.932959	0.934415	0.935184	0.93609	0.936804	0.935074	0.929306	0.924774	0.923126	0.922906	0.92406	0.925763	0.926285	0.927576	0.929086	0.929608	0.929526	0.929443	0.929416	0.929059	0.930267	0.930789	0.932245	0.933371	0.933893	0.935513	0.936008	0.936337	0.937079	0.931586	0.927493	0.924857	0.922934	0.923126	0.923923	0.924692	0.926697	0.927933	0.92829	0.928949	0.929059	0.928812	0.929114	0.929279	0.929581	0.930789	0.93219	0.932355	0.934058	0.935266	0.935623	0.936694	0.937134	0.935486	0.929828	0.924609	0.923758	0.924115	0.925214	0.926477	0.927438	0.928207	0.929883	0.93024	0.930157	0.929663	0.929581	0.929608	0.930185	0.930927	0.931586	0.932739	0.933234	0.934305	0.935239	0.935541	0.935788	0.933014	0.925873	0.924033	0.922797	0.923044	0.924088	0.925543	0.926038	0.927933	0.928592	0.928592	0.928812	0.928564	0.928812	0.929498	0.930487	0.931119	0.93208	0.933124	0.933701	0.934909	0.935458	0.936118	0.935266	0.930075	0.92623	0.923071	0.922165	0.922385	0.923566	0.924802	0.92612	0.927356	0.927768	0.9284	0.928235	0.928262	0.928619	0.929251	0.929883	0.931119	0.932355	0.932657	0.934003	0.935156	0.935513	0.93631	0.934552	0.931393	0.925021	0.922549	0.922824	0.923868	0.924802	0.925735	0.927191	0.928372	0.928894	0.928784	0.928564	0.928098	0.92807	0.928262	0.929306	0.93002	0.930954	0.93186	0.932877	0.933344	0.934497	0.934607	0.932217	0.926477	0.922852	0.921671	0.920764	0.922055	0.922989	0.92417	0.925406	0.926669	0.927301	0.927328	0.926971	0.927026	0.926889	0.927795	0.928647	0.929361	0.930652	0.931778	0.932327	0.932657	0.933948	0.933948	0.930624	0.925214	0.921835	0.920297	0.920874	0.921313	0.922961	0.923978	0.924939	0.926367	0.926642	0.926917	0.926999	0.926752	0.927713	0.92796	0.928619	0.930103	0.930927	0.931696	0.932492	0.933536	0.934058	0.933563	0.927274	0.92439	0.921231	0.920709	0.921396	0.922852	0.924005	0.925269	0.92634	0.927191	0.927411	0.926669	0.926367	0.925983	0.926559	0.927411	0.928592	0.929663	0.930185	0.931339	0.932162	0.932492	0.933234	0.929388	0.925186	0.921121	0.919254	0.919528	0.920544	0.921341	0.922797	0.923813	0.924637	0.925653	0.925186	0.925296	0.924911	0.925626	0.926202	0.927191	0.928482	0.929718	0.930048	0.931091	0.93186	0.93241	0.93219	0.929993	0.923758	0.919556	0.918457	0.918759	0.92005	0.921204	0.922137	0.923154	0.924637	0.924829	0.925104	0.924911	0.924774	0.925406	0.926312	0.927219	0.928043	0.929196	0.930075	0.931531	0.931888	0.932767	0.932767	0.927521	0.92211	0.920599	0.919556	0.920352	0.921204	0.922137	0.922687	0.924692	0.925763	0.925543	0.925488	0.925021	0.924884	0.925269	0.926367	0.926834	0.927933	0.929196	0.929883	0.930679	0.931696	0.932135	0.930075	0.924692	0.921835	0.918759	0.918512	0.919281	0.920352	0.921341	0.923071	0.923785	0.924252	0.9245	0.924033	0.924142	0.924417	0.925269	0.925735	0.926917	0.928235	0.928812	0.929636	0.930679	0.931174	0.931531	0.93024	0.9245	0.920078	0.91799	0.917606	0.918869	0.919583	0.921039	0.921945	0.923181	0.923868	0.924307	0.923785	0.923676	0.924225	0.924197	0.925516	0.926999	0.927603	0.928564	0.929993	0.930542	0.931284	0.931586	0.929993	0.924966	0.920517	0.918896	0.918182	0.918814	0.919885	0.921121	0.922165	0.923373	0.924362	0.924692	0.923923	0.923978	0.924142	0.924527	0.925214	0.926065	0.927356	0.928427	0.928922	0.929745	0.930817	0.930762	0.929333	0.923483	0.919006	0.917194	0.916837	0.91832	0.919226	0.919968	0.921121	0.923044	0.923126	0.923154	0.922906	0.922714	0.923154	0.923264	0.923758	0.925433	0.926862	0.927219	0.928482	0.929279	0.929526	0.930075	0.928812	0.925296	0.920462	0.917029	0.91626	0.917029	0.918237	0.919254	0.921011	0.92189	0.922549	0.922742	0.922275	0.92178	0.922659	0.923099	0.923483	0.924911	0.925323	0.926834	0.927219	0.927658	0.928262	0.929416	0.929608	0.928537	0.921451	0.918402	0.916232	0.915628	0.916534	0.917441	0.917743	0.918951	0.920901	0.921368	0.921313	0.921341	0.921231	0.921561	0.922055	0.923044	0.924033	0.925296	0.925708	0.926917	0.927713	0.928152	0.929169	0.927988	0.924033	0.918622	0.915244	0.914886	0.915601	0.916562	0.917908	0.919006	0.91983	0.921176	0.921066	0.921313	0.920764	0.92049	0.921039	0.922275	0.923209	0.924088	0.9259	0.926367	0.927164	0.92807	0.928784	0.928812	0.927081	0.919693	0.917276	0.915024	0.916095	0.916507	0.917798	0.918759	0.920599	0.92189	0.921973	0.921725	0.922055	0.921863	0.922192	0.923291	0.92395	0.925241	0.926669	0.927548	0.928098	0.929059	0.929279	0.930103	0.92991	0.927026	0.921451	0.918182	0.917111	0.917935	0.919913	0.920682	0.922412	0.923154	0.924307	0.924225	0.924115	0.923813	0.923923	0.92417	0.924802	0.926093	0.927081	0.928482	0.929224	0.929553	0.93046	0.930762	0.930652	0.925186	0.920847	0.919556	0.918457	0.919418	0.919611	0.921204	0.922165	0.924252	0.924884	0.925131	0.924554	0.92439	0.924252	0.924884	0.926422	0.926944	0.927768	0.9298	0.929965	0.930624	0.931503	0.931778	0.930075	0.924582	0.921863	0.919308	0.919748	0.92027	0.921863	0.923016	0.924197	0.925433	0.925873	0.925708	0.9259	0.925433	0.926202	0.926779	0.927603	0.928702	0.929691	0.930185	0.931229	0.932053	0.932602	0.932574	0.928976	0.925021	0.921121	0.92038	0.920737	0.922247	0.923483	0.924582	0.925735	0.926257	0.926147	0.926477	0.926065	0.92612	0.926697	0.927246	0.928839	0.929855	0.930157	0.931009	0.932327	0.932217	0.932877	0.929059	0.925543	0.922083	0.920901	0.921121	0.922192	0.922852	0.92406	0.925763	0.926312	0.926669	0.926697	0.925955	0.92579	0.926367	0.926669	0.928043	0.929279	0.929745	0.931064	0.931696	0.9323	0.932767	0.932712	0.929965	0.924719	0.921643	0.921149	0.921863	0.922604	0.924747	0.925845	0.926807	0.927466	0.927933	0.927219	0.927356	0.926724	0.927603	0.9284	0.928812	0.929993	0.930954	0.931558	0.93219	0.933234	0.933701	0.933755	0.930624	0.924252	0.922742	0.922083	0.923154	0.924362	0.925571	0.926505	0.928043	0.928592	0.928729	0.928262	0.927686	0.927823	0.92829	0.929086	0.930103	0.930872	0.932327	0.932712	0.933508	0.934085	0.93436	0.931833	0.926505	0.92439	0.922934	0.922522	0.923071	0.924747	0.925598	0.92774	0.928482	0.928317	0.92829	0.927576	0.927109	0.927713	0.928537	0.929114	0.93002	0.931201	0.93175	0.932465	0.933261	0.93392	0.930981	0.924857	0.922879	0.920627	0.921176	0.921643	0.922961	0.924088	0.925076	0.926395	0.926065	0.926202	0.925488	0.9259	0.925845	0.926697	0.926862	0.928015	0.929279	0.929965	0.930295	0.931531	0.931586	0.929169	0.923593	0.920792	0.91832	0.91799	0.918842	0.920682	0.920599	0.921808	0.923016	0.923291	0.923373	0.922083	0.922385	0.922879	0.923648	0.92428	0.925241	0.926559	0.926917	0.927383	0.928812	0.928592	0.925983	0.920654	0.916809	0.915765	0.91582	0.916342	0.91777	0.918787	0.91972	0.920984	0.921341	0.920984	0.920847	0.920297	0.920929	0.921753	0.922083	0.923648	0.924637	0.925626	0.926422	0.927109	0.927328	0.92634	0.919473	0.917166	0.915244	0.914832	0.915848	0.917276	0.917578	0.919281	0.920792	0.920709	0.920572	0.92027	0.920078	0.920572	0.921094	0.921973	0.923099	0.924472	0.925351	0.926422	0.927328	0.927988	0.928592	0.926147	0.92211	0.9181	0.91637	0.916562	0.9181	0.919089	0.921231	0.922632	0.922906	0.923264	0.923099	0.922797	0.922742	0.923676	0.923978	0.925076	0.926257	0.926917	0.928235	0.928976	0.929443	0.929993	0.928537	0.924774	0.92016	0.917798	0.916974	0.917578	0.918951	0.92027	0.921725	0.922742	0.923868	0.92373	0.923318	0.923236	0.923703	0.923895	0.924747	0.925955	0.926779	0.92829	0.928729	0.930048	0.930624	0.929855	0.926532	0.91983	0.917798	0.917496	0.917798	0.919473	0.920654	0.922028	0.922852	0.924225	0.923923	0.923676	0.923456	0.923428	0.92406	0.924692	0.926395	0.927081	0.928207	0.929031	0.929828	0.930652	0.931064	0.93002	0.923318	0.919638	0.918622	0.918457	0.919803	0.920709	0.92222	0.923593	0.924911	0.925598	0.925351	0.924472	0.924747	0.924774	0.925708	0.926697	0.927466	0.928372	0.929306	0.93013	0.930734	0.931531	0.931668	0.928098	0.924582	0.921286	0.918732	0.918265	0.919473	0.921176	0.92244	0.923566	0.924554	0.925104	0.925214	0.924197	0.923566	0.924197	0.925104	0.925708	0.927301	0.928647	0.929031	0.929718	0.930899	0.931064	0.93024	0.924774	0.919666	0.917303	0.916919	0.917633	0.918759	0.919885	0.920819	0.922467	0.923428	0.923346	0.922824	0.923209	0.922659	0.922961	0.923895	0.925214	0.92645	0.927576	0.928619	0.929416	0.929883	0.93024	0.926642	0.923016	0.918402	0.916534	0.916534	0.917303	0.918347	0.919556	0.92178	0.922549	0.923181	0.923071	0.922769	0.922906	0.923154	0.923923	0.924884	0.925955	0.926724	0.928207	0.929196	0.929883	0.930652	0.930899	0.929086	0.923346	0.918155	0.917496	0.917798	0.919254	0.921149	0.922742	0.923785	0.924966	0.925323	0.925049	0.924692	0.924911	0.925159	0.92634	0.927576	0.92829	0.929883	0.930927	0.931531	0.932767	0.933151	0.933755	0.929306	0.923813	0.921451	0.920627	0.921698	0.922549	0.924005	0.925186	0.927219	0.92774	0.927933	0.927411	0.927109	0.926697	0.926779	0.927795	0.928647	0.929471	0.930597	0.931256	0.932135	0.932739	0.933289	0.932355	0.926944	0.923209	0.92016	0.920132	0.920929	0.92244	0.92406	0.925543	0.927219	0.927576	0.927356	0.926999	0.926614	0.926697	0.927658	0.928455	0.929718	0.930872	0.931448	0.932767	0.932767	0.933838	0.933426	0.928207	0.924554	0.920215	0.919583	0.920325	0.921368	0.923209	0.92428	0.925516	0.926147	0.926367	0.926093	0.926093	0.925955	0.926669	0.926889	0.92796	0.929773	0.93013	0.930899	0.931558	0.932492	0.932465	0.929663	0.92384	0.919885	0.918567	0.919116	0.920462	0.921451	0.922742	0.924664	0.924966	0.925131	0.925104	0.924802	0.924637	0.924994	0.925516	0.926477	0.927548	0.928482	0.929279	0.93035	0.930515	0.931531	0.931174	0.927109	0.921423	0.918182	0.917331	0.918237	0.919144	0.920572	0.922275	0.922989	0.92395	0.92406	0.923978	0.923566	0.923648	0.924747	0.925351	0.926779	0.927603	0.928729	0.929333	0.93046	0.930762	0.931723	0.931998	0.927795	0.92049	0.918814	0.917084	0.91799	0.919418	0.920544	0.921259	0.922934	0.923456	0.923181	0.922824	0.92233	0.92222	0.922879	0.923895	0.924664	0.926257	0.926834	0.927768	0.928702	0.929388	0.930048	0.929526	0.922906	0.919254	0.916507	0.91571	0.916177	0.917578	0.91788	0.918869	0.920764	0.920819	0.921561	0.921671	0.921341	0.920901	0.921808	0.922769	0.923868	0.924417	0.925488	0.926642	0.927521	0.92774	0.928564	0.929114	0.927411	0.92178	0.916397	0.915134	0.915079	0.916287	0.917276	0.918045	0.919281	0.921341	0.921478	0.921698	0.921643	0.921423	0.922055	0.922906	0.923648	0.924472	0.925351	0.926944	0.927274	0.928564	0.928757	0.929224	0.929663	0.925351	0.921341	0.917633	0.915985	0.91626	0.917661	0.918649	0.920325	0.922083	0.922192	0.922604	0.922742	0.92222	0.922604	0.923154	0.924005	0.924911	0.926093	0.926944	0.927878	0.928757	0.929169	0.930487	0.930185	0.929581	0.922687	0.919501	0.917551	0.916672	0.917908	0.919144	0.920792	0.921835	0.923511	0.923785	0.92395	0.923813	0.923483	0.923895	0.923923	0.925351	0.926175	0.926999	0.92807	0.928922	0.929636	0.930322	0.930624	0.930322	0.925818	0.921643	0.917386	0.916727	0.917276	0.918594	0.920242	0.921808	0.922852	0.923236	0.922742	0.922577	0.922247	0.922385	0.922522	0.923373	0.924252	0.925461	0.926505	0.927219	0.928152	0.929141	0.929718	0.929773	0.9284	0.921066	0.917386	0.916672	0.917029	0.919885	0.920599	0.92244	0.923676	0.924994	0.925488	0.925351	0.924994	0.925626	0.926367	0.92774	0.93024	0.931641	0.933398	0.935568	0.935953	0.937106	0.937546	0.937408	0.932684	0.927686	0.925626	0.925378	0.925598	0.926724	0.92796	0.929745	0.930652	0.931448	0.931476	0.930707	0.929498	0.929883	0.930048	0.930981	0.931723	0.933179	0.933755	0.93436	0.935843	0.936639	0.936008	0.931339	0.927686	0.926312	0.926917	0.928125	0.929526	0.932162	0.933618	0.934799	0.935596	0.935953	0.935733	0.936667	0.936777	0.938315	0.938672	0.939633	0.941364	0.942325	0.942682	0.944055	0.944769	0.943835	0.938864	0.933536	0.932877	0.933041	0.934854	0.9362	0.938535	0.93999	0.940512	0.940704	0.940375	0.939413	0.939139	0.93999	0.94021	0.940869	0.941721	0.942929	0.942874	0.943039	0.942929	0.939716	0.935568	0.931256	0.930322	0.930569	0.931641	0.932794	0.934799	0.936145	0.93642	0.936255	0.935046	0.934579	0.93403	0.934497	0.934882	0.935376	0.937051	0.937738	0.93815	0.939276	0.938535	0.932877	0.928427	0.927246	0.926175	0.926477	0.927493	0.928729	0.930405	0.93197	0.932217	0.931668	0.934058	0.933398	0.932932	0.932382	0.93252	0.933096	0.933371	0.934744	0.935486	0.936447	0.935101	0.930872	0.927658	0.925681	0.925653	0.926587	0.927246	0.928674	0.930872	0.931366	0.93175	0.931641	0.931503	0.93197	0.932245	0.932739	0.933838	0.934909	0.935596	0.937436	0.937875	0.93815	0.936584	0.93046	0.928345	0.927274	0.927246	0.92818	0.929333	0.930185	0.931558	0.933069	0.932437	0.932465	0.932245	0.93197	0.931998	0.932739	0.933316	0.934167	0.934744	0.935294	0.937024	0.936832	0.935925	0.9298	0.926669	0.9259	0.925983	0.927136	0.927905	0.929141	0.930185	0.931256	0.931558	0.931531	0.931146	0.931311	0.931586	0.932272	0.933289	0.933508	0.93436	0.935239	0.935733	0.936172	0.932492	0.929498	0.925488	0.925049	0.925516	0.92634	0.927081	0.92796	0.929498	0.92991	0.930734	0.930597	0.930899	0.931009	0.931778	0.931943	0.933069	0.934415	0.935101	0.93576	0.936475	0.936859	0.936969	0.933591	0.929498	0.927383	0.927438	0.927466	0.928674	0.929443	0.930048	0.931174	0.93219	0.932162	0.932135	0.93208	0.932108	0.93252	0.932822	0.933975	0.934689	0.935266	0.936145	0.937244	0.937244	0.937711	0.933673	0.930624	0.92829	0.927136	0.928152	0.929224	0.929443	0.93046	0.93175	0.932108	0.932382	0.932245	0.931915	0.93219	0.932629	0.933151	0.934305	0.935019	0.935294	0.93653	0.936612	0.937024	0.937463	0.935431	0.93197	0.928674	0.927191	0.927191	0.92829	0.928949	0.93013	0.931119	0.931778	0.932355	0.932217	0.932245	0.931696	0.93175	0.932245	0.933261	0.934634	0.934854	0.936887	0.937381	0.937656	0.938644	0.939001	0.937628	0.932629	0.929059	0.928619	0.928702	0.929883	0.929938	0.930762	0.93186	0.932355	0.933453	0.933508	0.933206	0.933646	0.933865	0.934662	0.935321	0.936392	0.937326	0.938397	0.939139	0.939825	0.940292	0.940567	0.940155	0.936584	0.933398	0.931201	0.931174	0.931613	0.933261	0.934113	0.935815	0.936612	0.936832	0.937024	0.936502	0.936447	0.936832	0.937381	0.938205	0.938397	0.939029	0.94032	0.941254	0.94216	0.942517	0.943176	0.943478	0.942984	0.93631	0.93241	0.931339	0.931009	0.93241	0.933069	0.934113	0.935623	0.936914	0.937408	0.937161	0.936859	0.937134	0.937326	0.937738	0.938425	0.938892	0.939578	0.940649	0.941968	0.942572	0.943396	0.943808	0.942078	0.937381	0.935623	0.932932	0.932712	0.932822	0.934167	0.934964	0.936227	0.937271	0.938123	0.938397	0.938232	0.93815	0.938095	0.93848	0.939386	0.940073	0.941611	0.942297	0.943039	0.94422	0.945181	0.945758	0.945264	0.943533	0.937079	0.93436	0.93403	0.934937	0.936145	0.937299	0.939029	0.93999	0.940485	0.941061	0.940759	0.940594	0.940594	0.940979	0.941583	0.94227	0.943066	0.944	0.945154	0.945621	0.946225	0.947021	0.947708	0.945236	0.94032	0.937628	0.935431	0.935376	0.936035	0.938013	0.939056	0.94043	0.941281	0.941446	0.940704	0.940704	0.940704	0.941089	0.941693	0.942325	0.943643	0.944687	0.945016	0.94617	0.946939	0.947104	0.947076	0.945209	0.939633	0.935623	0.93425	0.934113	0.935376	0.935706	0.937326	0.939716	0.940567	0.941171	0.941226	0.940512	0.940512	0.940704	0.940924	0.941885	0.942957	0.943781	0.94444	0.945621	0.94584	0.946857	0.947269	0.94628	0.940759	0.93653	0.93447	0.933728	0.934854	0.935706	0.937381	0.938232	0.939386	0.940073	0.939716	0.939468	0.939359	0.939441	0.940018	0.940952	0.941226	0.942352	0.943369	0.944412	0.944879	0.94584	0.945868	0.946362	0.940897	0.937463	0.934415	0.933206	0.933453	0.934854	0.935458	0.937518	0.938589	0.939084	0.939496	0.938589	0.938315	0.938589	0.939001	0.939688	0.94021	0.941418	0.941721	0.942737	0.942984	0.943616	0.943753	0.942215	0.938782	0.933398	0.930487	0.929745	0.929938	0.930707	0.932108	0.933398	0.934277	0.934827	0.934607	0.934717	0.934634	0.934332	0.935046	0.935925	0.937271	0.93826	0.939166	0.940182	0.94054	0.941583	0.941556	0.938754	0.933151	0.928564	0.927328	0.927274	0.929114	0.928812	0.930157	0.931036	0.932959	0.933124	0.932547	0.932629	0.932465	0.932849	0.933426	0.93425	0.935349	0.93653	0.937436	0.938397	0.939276	0.939771	0.940237	0.935843	0.930679	0.928537	0.926175	0.926999	0.927383	0.928784	0.929498	0.931586	0.932547	0.932382	0.93241	0.932437	0.932602	0.933069	0.934003	0.934991	0.935321	0.93653	0.937134	0.93848	0.939056	0.939853	0.939771	0.937628	0.934113	0.928812	0.926642	0.926889	0.927576	0.928922	0.930844	0.93219	0.932904	0.933344	0.932986	0.932465	0.932629	0.933124	0.933453	0.934277	0.935678	0.936694	0.937463	0.938342	0.938919	0.939853	0.939468	0.936282	0.931476	0.928455	0.927795	0.927795	0.928152	0.929279	0.931311	0.932245	0.933865	0.934222	0.934195	0.933948	0.934167	0.934442	0.935513	0.93642	0.936969	0.93793	0.939359	0.939798	0.940924	0.941611	0.941528	0.938919	0.93392	0.930432	0.929526	0.93002	0.930844	0.933261	0.934277	0.935266	0.935953	0.935953	0.93609	0.935651	0.935651	0.93609	0.936639	0.937244	0.93826	0.939468	0.940402	0.940924	0.941803	0.942133	0.93999	0.935129	0.930872	0.929169	0.929141	0.929691	0.931284	0.932465	0.934003	0.935019	0.935349	0.935431	0.935239	0.935019	0.935541	0.936255	0.936832	0.937903	0.938947	0.939771	0.940594	0.941089	0.941473	0.940375	0.933508	0.932327	0.929169	0.928098	0.928867	0.930432	0.931119	0.932602	0.934277	0.934662	0.934827	0.934415	0.93414	0.934579	0.935541	0.935953	0.936749	0.938782	0.939001	0.940375	0.940897	0.941309	0.94216	0.939386	0.935733	0.931586	0.929855	0.929251	0.930432	0.931339	0.933591	0.934909	0.935129	0.935678	0.934882	0.934827	0.934607	0.934991	0.935266	0.93642	0.937134	0.938177	0.938892	0.939771	0.940155	0.940622	0.939386	0.93598	0.930844	0.927603	0.926807	0.927301	0.928729	0.929938	0.931476	0.93175	0.932877	0.932547	0.932492	0.932108	0.932684	0.933289	0.93392	0.935321	0.935898	0.937216	0.937958	0.938397	0.938754	0.935815	0.933948	0.92785	0.925735	0.925241	0.925955	0.926642	0.927823	0.929471	0.930295	0.930954	0.930762	0.930624	0.930981	0.931256	0.931696	0.932932	0.933783	0.934772	0.935678	0.937189	0.937491	0.93782	0.938452	0.937106	0.930322	0.926505	0.925131	0.925269	0.926038	0.926697	0.927933	0.929553	0.930405	0.930899	0.930322	0.930707	0.930872	0.931036	0.932025	0.933124	0.933563	0.93436	0.93587	0.936365	0.937271	0.937656	0.93815	0.937463	0.933179	0.929553	0.926038	0.925433	0.92601	0.927274	0.928235	0.929636	0.930432	0.930899	0.930981	0.931229	0.930679	0.931503	0.931888	0.93252	0.933838	0.934909	0.93576	0.936584	0.936859	0.937408	0.93804	0.938507	0.937491	0.932437	0.927576	0.925433	0.924307	0.924966	0.925516	0.927411	0.928455	0.928894	0.929196	0.929498	0.92851	0.9284	0.928922	0.929828	0.931174	0.932382	0.933563	0.934909	0.935376	0.935898	0.936694	0.936777	0.937628	0.936612	0.933344	0.928043	0.925159	0.924554	0.925049	0.926422	0.926807	0.928482	0.928757	0.929251	0.929416	0.929224	0.928949	0.929361	0.929663	0.930679	0.93175	0.932547	0.93403	0.934525	0.935486	0.935678	0.93653	0.936996	0.937408	0.934552	0.931284	0.926779	0.924884	0.924088	0.925159	0.926175	0.926669	0.928839	0.929443	0.929526	0.929196	0.928976	0.928729	0.929498	0.930048	0.931201	0.932382	0.932932	0.934442	0.935513	0.936118	0.937024	0.93804	0.938452	0.937738	0.933755	0.928867	0.925433	0.925021	0.925873	0.927438	0.928729	0.930405	0.932025	0.932108	0.93208	0.931229	0.931009	0.931421	0.932272	0.932767	0.933865	0.93425	0.935458	0.9362	0.936914	0.937189	0.93793	0.93826	0.937518	0.933371	0.927631	0.924774	0.924225	0.924939	0.925708	0.927823	0.928674	0.93013	0.930899	0.931174	0.931421	0.931641	0.932108	0.933069	0.933783	0.934167	0.935294	0.936008	0.936969	0.937711	0.939001	0.939771	0.940594	0.937134	0.933728	0.929828	0.928043	0.928976	0.929636	0.930817	0.93252	0.935266	0.935843	0.936447	0.936859	0.936722	0.936612	0.936337	0.936996	0.937518	0.938699	0.939304	0.940952	0.941638	0.942407	0.942792	0.940594	0.937051	0.932877	0.930267	0.930707	0.931503	0.933014	0.934882	0.936832	0.936887	0.937985	0.937683	0.937656	0.937408	0.937985	0.938177	0.939331	0.9401	0.941034	0.941803	0.942352	0.943094	0.943945	0.941226	0.936996	0.930954	0.929471	0.929279	0.93013	0.931146	0.933041	0.934332	0.935184	0.93598	0.935733	0.935898	0.935843	0.93631	0.936639	0.937299	0.938507	0.939661	0.940182	0.941556	0.942078	0.942819	0.940182	0.936255	0.930624	0.928894	0.929169	0.930624	0.931174	0.932712	0.934167	0.934607	0.935431	0.935678	0.935431	0.935046	0.935541	0.93576	0.936392	0.937875	0.938644	0.939935	0.94054	0.94183	0.94227	0.940018	0.93436	0.930075	0.927795	0.927933	0.929718	0.930652	0.931641	0.933069	0.934003	0.935074	0.934991	0.934634	0.934689	0.935376	0.935678	0.936942	0.937903	0.938507	0.939853	0.940814	0.941309	0.941556	0.94194	0.93782	0.932135	0.928619	0.927081	0.927054	0.92851	0.929526	0.930762	0.931778	0.932877	0.93381	0.933673	0.933591	0.933755	0.93381	0.935046	0.93609	0.936777	0.937546	0.939029	0.939359	0.939798	0.940814	0.939963	0.934964	0.929691	0.927191	0.927026	0.92785	0.929086	0.930405	0.930817	0.931613	0.933234	0.933206	0.933316	0.933151	0.933344	0.934332	0.934909	0.935376	0.937354	0.938232	0.938837	0.939523	0.940485	0.940485	0.940292	0.933124	0.929773	0.926724	0.925873	0.926724	0.927631	0.92829	0.929114	0.930569	0.931339	0.931558	0.931311	0.931009	0.931009	0.931613	0.932492	0.933316	0.934717	0.935953	0.936557	0.937518	0.938315	0.938727	0.939606	0.938068	0.932327	0.926669	0.925433	0.925571	0.926532	0.927521	0.928317	0.929279	0.93024	0.931119	0.931339	0.931229	0.930927	0.931393	0.931531	0.933289	0.934744	0.936008	0.936694	0.937601	0.939139	0.939661	0.940512	0.941116	0.938562	0.935046	0.929636	0.927191	0.926999	0.928125	0.928729	0.931064	0.932547	0.933124	0.934058	0.934689	0.934415	0.934579	0.935046	0.935321	0.936502	0.937793	0.938947	0.939743	0.940649	0.941556	0.942545	0.943314	0.943506	0.943588	0.938837	0.935019	0.932025	0.930542	0.931531	0.932629	0.933701	0.935376	0.937189	0.937766	0.938068	0.937985	0.937601	0.937573	0.937766	0.938617	0.939139	0.940128	0.941061	0.942105	0.942572	0.943066	0.944385	0.944714	0.944522	0.93988	0.933179	0.93197	0.931091	0.932465	0.933508	0.934882	0.935706	0.937793	0.938397	0.938809	0.93837	0.938315	0.93848	0.938809	0.939963	0.940952	0.941501	0.942902	0.943533	0.94444	0.945154	0.945374	0.945758	0.942242	0.938617	0.933755	0.931393	0.931009	0.932272	0.933261	0.934662	0.936447	0.937546	0.937848	0.938205	0.937711	0.937985	0.938535	0.938617	0.939551	0.941006	0.941556	0.942215	0.943478	0.944412	0.945236	0.945621	0.944962	0.938397	0.933838	0.932437	0.931888	0.932767	0.933673	0.934991	0.936227	0.936996	0.937958	0.938452	0.938013	0.937491	0.937408	0.93793	0.938315	0.939166	0.940485	0.941776	0.942462	0.942929	0.943533	0.944357	0.941748	0.936392	0.933673	0.930377	0.930487	0.931119	0.932382	0.933179	0.934415	0.935925	0.936172	0.936227	0.936282	0.936118	0.936392	0.937161	0.937408	0.938644	0.940018	0.940814	0.941611	0.942462	0.943039	0.943314	0.941556	0.938123	0.9323	0.929938	0.929581	0.930981	0.931448	0.932355	0.933453	0.935101	0.935651	0.935843	0.935678	0.935678	0.936172	0.936475	0.937601	0.938809	0.939496	0.940347	0.941638	0.94216	0.942874	0.943149	0.942352	0.937628	0.933316	0.930734	0.930515	0.931064	0.931393	0.933316	0.933948	0.935568	0.936063	0.936914	0.936337	0.936392	0.936722	0.937161	0.937656	0.938177	0.939523	0.940567	0.941006	0.941693	0.942709	0.943259	0.942627	0.938397	0.933453	0.930624	0.929471	0.929938	0.930432	0.931256	0.932108	0.934085	0.934991	0.934689	0.933975	0.933344	0.932986	0.933179	0.934113	0.934579	0.935541	0.935788	0.936832	0.936502	0.936942	0.937299	0.93175	0.928867	0.9259	0.924939	0.925296	0.925323	0.926175	0.926862	0.928922	0.929141	0.929828	0.929636	0.929718	0.929855	0.930405	0.931229	0.932382	0.933481	0.933975	0.935486	0.935898	0.936694	0.937408	0.938123	0.937408	0.932629	0.926917	0.9259	0.925021	0.924857	0.9259	0.926834	0.927383	0.928702	0.930103	0.930652	0.930762	0.930542	0.930844	0.931888	0.932327	0.933316	0.934909	0.93642	0.936859	0.938425	0.939331	0.940073	0.941089	0.942078	0.940485	0.93598	0.932053	0.93175	0.932053	0.932986	0.934744	0.935541	0.93653	0.93826	0.938617	0.938617	0.939111	0.938947	0.938947	0.939551	0.940787	0.941885	0.943314	0.944028	0.945181	0.946115	0.946527	0.947021	0.948285	0.949219	0.947818	0.943506	0.93999	0.939908	0.940265	0.941721	0.942407	0.943726	0.944604	0.945731	0.946115	0.946033	0.945923	0.945895	0.946088	0.946664	0.948065	0.949191	0.95018	0.950894	0.951443	0.95257	0.952597	0.952762	0.953668	0.953833	0.952515	0.948669	0.946527	0.946088	0.946692	0.947681	0.949713	0.951196	0.951443	0.952789	0.952982	0.952625	0.952075	0.952734	0.952377	0.952899	0.953998	0.954849	0.955893	0.956442	0.957266	0.958282	0.958475	0.95864	0.959189	0.956937	0.954108	0.951636	0.951718	0.951553	0.953036	0.954025	0.955206	0.956662	0.957184	0.957761	0.957211	0.957019	0.956799	0.957211	0.957706	0.957925	0.958997	0.959546	0.960892	0.961661	0.961935	0.963007	0.962952	0.963281	0.961194	0.956332	0.955508	0.955563	0.956827	0.957486	0.958832	0.959189	0.960287	0.960809	0.961386	0.961139	0.960095	0.960315	0.96059	0.961331	0.961688	0.962347	0.963226	0.963913	0.964627	0.965149	0.965424	0.965945	0.964545	0.961935	0.959299	0.959299	0.959491	0.96059	0.961057	0.962402	0.962924	0.963446	0.963611	0.963528	0.963281	0.963446	0.963309	0.963831	0.964655	0.965479	0.965616	0.966632	0.966907	0.967429	0.968143	0.967703	0.968253	0.965259	0.962238	0.961688	0.961496	0.962347	0.963309	0.963501	0.96438	0.965094	0.965616	0.966	0.965588	0.965479	0.965561	0.965479	0.96611	0.966522	0.967346	0.968335	0.968582	0.968939	0.969406	0.970093	0.970422	0.968857	0.96655	0.963611	0.963803	0.963748	0.964627	0.965918	0.966467	0.967291	0.967429	0.967786	0.967538	0.967511	0.967291	0.967346	0.967264	0.9685	0.969296	0.969159	0.970752	0.970642	0.970944	0.971878	0.971686	0.971988	0.971384	0.968665	0.966467	0.965451	0.965616	0.966522	0.967264	0.967868	0.968307	0.968994	0.969049	0.969543	0.968857	0.968884	0.968802	0.969241	0.969516	0.970258	0.970889	0.970917	0.971658	0.971933	0.971906	0.972592	0.973032	0.972839	0.971878	0.968692	0.967072	0.966248	0.966797	0.967566	0.968143	0.968692	0.969598	0.97001	0.970148	0.97012	0.969214	0.969489	0.969928	0.97012	0.970285	0.970779	0.972263	0.972949	0.973032	0.973169	0.973251	0.973553	0.973801	0.974048	0.972153	0.968884	0.968307	0.967126	0.967429	0.967868	0.968665	0.969296	0.970065	0.970285	0.970807	0.970697	0.970038	0.969873	0.969955	0.970395	0.970779	0.971521	0.972345	0.972839	0.973224	0.973444	0.973965	0.974103	0.974213	0.97457	0.974872	0.973361	0.970697	0.96817	0.967401	0.967621	0.968665	0.970038	0.970148	0.970697	0.970944	0.971191	0.971301	0.970807	0.970889	0.970752	0.970752	0.971494	0.972043	0.972894	0.973196	0.97402	0.97424	0.974652	0.974817	0.974927	0.975339	0.975421	0.974734	0.973087	0.969324	0.967484	0.966605	0.967401	0.967868	0.969241	0.969598	0.970175	0.970587	0.970697	0.970724	0.969873	0.969818	0.970395	0.97023	0.970477	0.971521	0.972427	0.972729	0.973141	0.973636	0.973718	0.974542	0.974597	0.975119	0.974982	0.975476	0.975586	0.975833	0.971713	0.969214	0.967538	0.967593	0.968143	0.969351	0.97067	0.970999	0.971521	0.972263	0.972153	0.971713	0.971054	0.971109	0.971548	0.971576	0.972043	0.973251	0.973911	0.974844	0.975119	0.975009	0.975916	0.975751	0.975888	0.976767	0.976492	0.977124	0.977151	0.975476	0.971603	0.968774	0.968225	0.96839	0.969543	0.970422	0.971274	0.972208	0.973087	0.972894	0.972592	0.972125	0.97196	0.971576	0.971906	0.972784	0.973526	0.973993	0.975009	0.975558	0.975833	0.976108	0.976932	0.976877	0.977042	0.977399	0.977289	0.977838	0.97814	0.977975	0.973334	0.97001	0.969681	0.969489	0.970889	0.971356	0.972455	0.972894	0.973663	0.973993	0.973526	0.973114	0.972647	0.972153	0.972263	0.973141	0.973361	0.974323	0.975174	0.975092	0.975916	0.97619	0.976328	0.97674	0.97674	0.976959	0.977042	0.975064	0.972482	0.969846	0.967896	0.96828	0.968912	0.969626	0.971054	0.971658	0.971851	0.972318	0.97218	0.972015	0.971219	0.970587	0.970834	0.970889	0.972372	0.972729	0.973828	0.974185	0.974542	0.974789	0.974762	0.975284	0.975641	0.975613	0.975806	0.97608	0.972235	0.969077	0.966714	0.966412	0.966742	0.967484	0.968747	0.968967	0.969434	0.969543	0.970093	0.969351	0.969653	0.968994	0.968967	0.968774	0.969571	0.970477	0.970917	0.971576	0.972318	0.972949	0.973059	0.973251	0.973663	0.973938	0.97424	0.97424	0.97424	0.970422	0.967346	0.965149	0.964764	0.965094	0.966165	0.966385	0.967319	0.967978	0.968198	0.967758	0.967017	0.966879	0.966522	0.966495	0.966797	0.967319	0.967978	0.968582	0.969846	0.970697	0.969955	0.971246	0.971027	0.971301	0.971686	0.971796	0.97056	0.966302	0.963391	0.961826	0.961798	0.962567	0.963474	0.964297	0.964545	0.965067	0.965121	0.964984	0.964655	0.964572	0.964078	0.96416	0.964627	0.965067	0.96666	0.966769	0.967511	0.967923	0.96806	0.96817	0.968939	0.969351	0.969626	0.969626	0.967236	0.962979	0.960205	0.959848	0.959958	0.960837	0.961523	0.962238	0.962759	0.963171	0.963226	0.962292	0.962265	0.962045	0.96199	0.962375	0.963583	0.963858	0.964545	0.965369	0.965918	0.966248	0.966632	0.967044	0.967374	0.966989	0.963116	0.959052	0.957349	0.956689	0.956332	0.957541	0.957733	0.95853	0.958832	0.959299	0.959326	0.958777	0.958502	0.958365	0.958447	0.958832	0.959656	0.960397	0.960782	0.961716	0.962265	0.962375	0.963089	0.963364	0.963501	0.962979	0.958667	0.955453	0.953558	0.953613	0.953833	0.954877	0.954904	0.955591	0.956003	0.95658	0.95636	0.956003	0.955728	0.955289	0.955371	0.955618	0.956744	0.957294	0.958008	0.958585	0.959216	0.959821	0.96015	0.960342	0.9582	0.954272	0.950839	0.94985	0.949521	0.950372	0.95062	0.950867	0.951031	0.952103	0.952213	0.952158	0.951773	0.951636	0.951718	0.952432	0.953366	0.953668	0.95452	0.955481	0.95603	0.956003	0.95658	0.956854	0.957101	0.955646	0.951993	0.948395	0.947076	0.946362	0.946939	0.947571	0.94801	0.949246	0.949823	0.949878	0.949741	0.949741	0.949329	0.949988	0.950317	0.950867	0.951801	0.952817	0.953311	0.953723	0.954355	0.954822	0.955096	0.955618	0.955426	0.952405	0.948505	0.945813	0.945209	0.945676	0.946472	0.946664	0.947406	0.948093	0.94845	0.948834	0.94834	0.94856	0.948175	0.948779	0.949438	0.950647	0.951471	0.951883	0.952762	0.953421	0.953586	0.954135	0.955096	0.954849	0.953531	0.949658	0.94595	0.944247	0.94411	0.944302	0.945538	0.945648	0.94595	0.946912	0.947296	0.947433	0.947104	0.946912	0.947159	0.947653	0.948203	0.949493	0.950372	0.950427	0.951828	0.952405	0.952679	0.953201	0.953751	0.95408	0.954465	0.951718	0.947461	0.944577	0.943341	0.943726	0.944495	0.945044	0.945483	0.946747	0.947159	0.947104	0.947296	0.946912	0.947324	0.947571	0.947763	0.948917	0.950455	0.950977	0.951691	0.952762	0.953064	0.953339	0.954108	0.953998	0.954465	0.955399	0.955261	0.951443	0.947708	0.945456	0.944467	0.94455	0.945648	0.946582	0.947021	0.947873	0.948724	0.94856	0.948477	0.948285	0.947928	0.948697];
y=signal.pleth.y;
x=linspace(0,length(y)/fs,length(y));
figure(1);
plot(x,y)
h=gcf;
axObj = get(h, 'Children');
datObj = get(axObj, 'Children');
xdata = get(datObj, 'XData');
ydata = get(datObj, 'YData');
inp.y=(ydata)';
inp.x=(xdata)';
[peaks onsets]=IMS(y,fs);
inp.peaks=peaks;
inp.onsets=onsets;
figure(2);
plot(inp.x,inp.y);
for i=1:size(inp.peaks)-1
    j=inp.peaks(i);
    yp=inp.y(j);
    k=inp.onsets(i);
    yo=inp.y(k);
    midy(i)=(yp+yo)/2;
    tp=inp.x(j);
    to=inp.x(k);
    midx(i)=(tp+to)/2;
end
for i=1:size(inp.peaks)-1
j=inp.peaks(i);
t1=inp.x(j);
k=inp.peaks(i+1);
t2=inp.x(k);
diff(i)=abs(t1-t2);
t(i)=t1;
diffinverse(i)=(diff(i))^(-1);

end
for i=1:size(inp.peaks)-1
j=inp.peaks(i);
p1=inp.y(j);
k=inp.onsets(i);
p2=inp.y(k);
amp(i)=abs(p1-p2);
t1=inp.x(j);
p3=inp.x(k);
t(i)=t1;
peak_y(i)=p1;
onset_y(i)=p2;
onset_x(i)=p3;
end

save('0009.mat','diffinverse','amp','midy','peak_y','onset_y');
%data=load('0009.mat');
%csvwrite('0009.csv',data);
%[peaks_y, locs_y] = findpeaks(x, y,'MinPeakDistance',4);

%[minval, minidx] = min( x(locs_y(1):locs_y(2)) );

%minidx is relative to the subset of values, so move it back to full range

%minidx = minidx + locs_co2(1) - 1;
%plot(x,co2);
co2=signal.co2.y;
co2_plot=co2;
mean_co2=mean(co2_plot);
for i=1:size(co2_plot)
    if(co2_plot(i)> mean_co2)
        co2_plot(i)=mean_co2;
        
   end
end

figure(3);
subplot(2,1,1);
plot(x,co2_plot);


tf_co2 = islocalmin(co2_plot);

onsx_co2=x(tf_co2);
onsy_co2=co2(tf_co2);
plot(x,co2_plot,onsx_co2,onsy_co2,'r*');
     



subplot(2,1,2);
plot(midx,midy);
tf = islocalmin(midx);
 onsx=midx(tf);
 onsy=midy(tf);
 figure(5)
 plot(midx,midy,onsx,onsy,'r*');
 

 %plot(x,y); hold off
 %exhalation
 L=csvread('2nd peaks.csv');
 %save('b_cycle.mat',L);
 P_sec=L(:,1);
 onset_b=L(:,2);
 for i=1:size(P_sec)-1 
    exh(i)= P_sec(i)-onset_b(i);
 end
 for i=1:size(P_sec)-1
     inh(i)=onset_b(i+1)-P_sec(i);
 end
amp_mod=(y(peaks)+y(onsets))/2;
amp_time=(x(peaks)+x(onsets))/2;

[amp_y1,amp_T]=resample(amp_mod,amp_time,10);

mean_midy=mean(amp_y1);
for i=1:size(amp_y1)
    if(amp_y1(i)> mean_midy)
        amp_y1(i)=mean_midy;
       
   end
end
tf = islocalmin(amp_y1);
 onsx=amp_T(tf);
 onsy=amp_y1(tf);
 figure(7);
 plot(amp_T,amp_y1,onsx,onsy,'r*');
 